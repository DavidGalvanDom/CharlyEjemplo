var Usuarios={colUsuairo:[],gridUsuarios:null,inicia:function(){this.eventos();this.CargarGrid()},eventos:function(){$("#UsuarioNuevo").click(Usuarios.onNuevo);$(document).on("click","#btn-GuardaNuevoUsuario",Usuarios.GuardarUsuario);$(document).on("click",".accrowBorrar",function(){Usuarios.Borrar($(this).parent().parent().attr("data-modelId"))})},Borrar:function(n){var t=contextPath+"Usuario/Borrar";$.post(t,{idUsuario:n},function(t){t.status===!0?(Usuarios.colUsuairo.remove(n),alert(t.mensaje)):console.log("Error "+t.mensaje)})},RedefinirValidaciones:function(){$("form").removeData("validator");$("form").removeData("unobtrusiveValidation");$.validator.unobtrusive.parse("form")},GuardarUsuario:function(){var n=contextPath+"Usuario/Nuevo";$("#usuarioCreacion").val("1");dataForm=$("#NuevoUsuarioForm *").serialize();$("form").valid()&&$.post(n,dataForm,function(n){n.status===!0?(Usuarios.colUsuairo.add(Usuarios.serializaUsuario(n.id,"#NuevoUsuarioForm")),$("#winUsuarioNuevo").modal("hide")):console.log("Error "+n.mensaje)})},onNuevo:function(){var n=contextPath+"Usuario/Nuevo";$.get(n,null,function(n){$("#winUsuarioNuevo").html(n);$("#winUsuarioNuevo").modal({backdrop:"static",keyboard:!0},"show");Usuarios.RedefinirValidaciones()})},serializaUsuario:function(n){return{id:n,Nombre:$("#Nombre").val(),Direccion:$("#Direccion").val()}},CargarGrid:function(){var n=contextPath+"Usuario/CargarUsuarios";$(".loading").show();$.post(n,null,function(n){if($(".loading").hide(),n.Success===!0){Usuarios.colUsuairo=new Backbone.Collection(n.data);var t=Usuarios.colUsuairo.length>0?!0:!1;t===!0&&(Usuarios.gridUsuarios=new bbGrid.View({container:$(".bbGrid-Usuario"),rows:200,rowList:[15,50,200,1e3],enableSearch:!1,actionenable:!0,detalle:!1,collection:Usuarios.colUsuairo,colModel:[{title:"Id",name:"id",width:"8%",sorttype:"number",filter:!0,filterType:"input"},{title:"Nombre",name:"Nombre",filter:!0,filterType:"input",index:!0},{title:"Direccion",name:"Direccion",filter:!0}]}))}else CHR.DespliegaError(n.Messages)}).fail(function(){$(".loading").html("<p>No se pudo cargar la informacion de los Usuarios<\/p>")})}};$(function(){Usuarios.inicia()});